

<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Protein Panel Expansion &mdash; scLinguist 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=92fd9be5" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=2389946f"></script>
      <script src="../_static/doctools.js?v=888ff710"></script>
      <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            scLinguist
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Credits</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">scLinguist</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Protein Panel Expansion</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorials/protein_panel_paths_aligned.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Protein-Panel-Expansion">
<h1>Protein Panel Expansion<a class="headerlink" href="#Protein-Panel-Expansion" title="Permalink to this heading"></a></h1>
<p>This notebook shows how to transfer customize protein data into correct shape for scLinguist.</p>
<section id="0.-Imports">
<h2>0. Imports<a class="headerlink" href="#0.-Imports" title="Permalink to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>import sys
sys.path.append(&#39;../../&#39;)
import numpy as np
import pandas as pd
import anndata as anndata
import scanpy as sc
from pathlib import Path
from scipy.sparse import csr_matrix
from scLinguist.data_loaders.data_loader import expand_protein_to_panel
</pre></div>
</div>
</div>
</section>
<section id="1.-Parameters">
<h2>1. Parameters<a class="headerlink" href="#1.-Parameters" title="Permalink to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>PANEL_PATH = Path(&#39;../../docs/tutorials/protein_index_map.csv&#39;)
PROTEIN_PATH = Path(&#39;../../data/test_sample_adt.h5ad&#39;)
OUTPUT_DIR = Path(&#39;../../docs/tutorials/expanded_output&#39;)
OUTPUT_DIR.mkdir(parents=True, exist_ok=True)
OUT_H5AD = OUTPUT_DIR / &#39;pro_expanded_6427.h5ad&#39;
COMPRESSION = &#39;gzip&#39;
</pre></div>
</div>
</div>
</section>
<section id="2.-Load-data-&amp;-target-panel">
<h2>2. Load data &amp; target panel<a class="headerlink" href="#2.-Load-data-&-target-panel" title="Permalink to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>pro = sc.read_h5ad(PROTEIN_PATH)[:, :10] # take 10 proteins as example
panel = pd.read_csv(PANEL_PATH, index_col=None)
panel = panel.name.tolist()
print(&#39;Protein AnnData:&#39;, pro.shape)
print(&#39;Panel length:&#39;, len(panel))
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Protein AnnData: (10546, 10)
Panel length: 6427
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>panel
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;SP110&#39;,
 &#39;GTPBA&#39;,
 &#39;SNX2&#39;,
 &#39;FRG1&#39;,
 &#39;TT21A&#39;,
 &#39;RHG18&#39;,
 &#39;AR&#39;,
 &#39;DOCK1&#39;,
 &#39;RAB1A&#39;,
 &#39;MUC1.HMFG2&#39;,
 &#39;H2B1L&#39;,
 &#39;RFC1&#39;,
 &#39;TXTP&#39;,
 &#39;MER34&#39;,
 &#39;IL.3&#39;,
 &#39;FXR2&#39;,
 &#39;ARMD3&#39;,
 &#39;ZDHC9&#39;,
 &#39;KAPCA&#39;,
 &#39;HH3&#39;,
 &#39;ZBT21&#39;,
 &#39;F149B&#39;,
 &#39;PDE10&#39;,
 &#39;PCD18&#39;,
 &#39;PEBB&#39;,
 &#39;PRI1&#39;,
 &#39;NU214&#39;,
 &#39;TNAP&#39;,
 &#39;JHD2C&#39;,
 &#39;MIC19&#39;,
 &#39;CD213A2&#39;,
 &#39;HYEP&#39;,
 &#39;ZFR&#39;,
 &#39;PUF60&#39;,
 &#39;GPAT3&#39;,
 &#39;DIDO1&#39;,
 &#39;CD185&#39;,
 &#39;AT12A&#39;,
 &#39;TATD1&#39;,
 &#39;ZN341&#39;,
 &#39;RPB3&#39;,
 &#39;APOC3&#39;,
 &#39;TCR.VY9&#39;,
 &#39;HS90B&#39;,
 &#39;EMAL6&#39;,
 &#39;WFS1&#39;,
 &#39;RS9&#39;,
 &#39;PGK2&#39;,
 &#39;TYW2&#39;,
 &#39;EF1B&#39;,
 &#39;IMB1&#39;,
 &#39;ACADM&#39;,
 &#39;PAR6A&#39;,
 &#39;CAP1&#39;,
 &#39;CD357&#39;,
 &#39;RGS7&#39;,
 &#39;TCTP&#39;,
 &#39;EXOS9&#39;,
 &#39;RT34&#39;,
 &#39;SQSTM&#39;,
 &#39;TBA1A&#39;,
 &#39;ENOPH&#39;,
 &#39;BAP18&#39;,
 &#39;AQR&#39;,
 &#39;SMRC1&#39;,
 &#39;FRIH&#39;,
 &#39;HS105&#39;,
 &#39;MORN3&#39;,
 &#39;TIM23&#39;,
 &#39;K1143&#39;,
 &#39;CXB3&#39;,
 &#39;CD72&#39;,
 &#39;UBP25&#39;,
 &#39;ECP&#39;,
 &#39;EF2&#39;,
 &#39;NSF1C&#39;,
 &#39;CD196&#39;,
 &#39;SPDE3&#39;,
 &#39;CCR10&#39;,
 &#39;PON2&#39;,
 &#39;PURB&#39;,
 &#39;PLCG2&#39;,
 &#39;TCPD&#39;,
 &#39;CPNE3&#39;,
 &#39;TCRG&#39;,
 &#39;MAOX&#39;,
 &#39;PEPL&#39;,
 &#39;NUF2&#39;,
 &#39;RYR2&#39;,
 &#39;LIMC1&#39;,
 &#39;CHM2B&#39;,
 &#39;LNX1&#39;,
 &#39;MARCS&#39;,
 &#39;ATP5E&#39;,
 &#39;ZBED6&#39;,
 &#39;FA47C&#39;,
 &#39;UBE4B&#39;,
 &#39;AAMDC&#39;,
 &#39;CGAS&#39;,
 &#39;AL1L1&#39;,
 &#39;PDE1A&#39;,
 &#39;VIR&#39;,
 &#39;AKP8L&#39;,
 &#39;APC&#39;,
 &#39;PLXD1&#39;,
 &#39;RNZ2&#39;,
 &#39;MYPC3&#39;,
 &#39;MRP5&#39;,
 &#39;PROF2&#39;,
 &#39;UBA3&#39;,
 &#39;ZN599&#39;,
 &#39;TCR.VB13.2&#39;,
 &#39;TTC1&#39;,
 &#39;NOP58&#39;,
 &#39;RL27A&#39;,
 &#39;INVO&#39;,
 &#39;IF16&#39;,
 &#39;SNX15&#39;,
 &#39;ARL8B&#39;,
 &#39;UNC80&#39;,
 &#39;RMD1&#39;,
 &#39;CD141&#39;,
 &#39;CS044&#39;,
 &#39;MXRA5&#39;,
 &#39;S10A6&#39;,
 &#39;LORF2&#39;,
 &#39;NDKB&#39;,
 &#39;CD56.1&#39;,
 &#39;EPB42&#39;,
 &#39;DIRC2&#39;,
 &#39;COPZ1&#39;,
 &#39;ECH1&#39;,
 &#39;SYNE1&#39;,
 &#39;MBB1A&#39;,
 &#39;GTF2I&#39;,
 &#39;PTN1&#39;,
 &#39;PGTB2&#39;,
 &#39;TRPM6&#39;,
 &#39;CORO7&#39;,
 &#39;DJC13&#39;,
 &#39;O14K1&#39;,
 &#39;PLIN3&#39;,
 &#39;LDHA&#39;,
 &#39;PP2BA&#39;,
 &#39;COPE&#39;,
 &#39;DPOLA&#39;,
 &#39;FHL5&#39;,
 &#39;SNX9&#39;,
 &#39;F200B&#39;,
 &#39;CD10&#39;,
 &#39;MPV17&#39;,
 &#39;STAT3&#39;,
 &#39;PAR3L&#39;,
 &#39;INT13&#39;,
 &#39;RPB11&#39;,
 &#39;CTL2&#39;,
 &#39;PACN1&#39;,
 &#39;GLYG2&#39;,
 &#39;KMT2B&#39;,
 &#39;LXN&#39;,
 &#39;RFA1&#39;,
 &#39;DPOG1&#39;,
 &#39;O10J4&#39;,
 &#39;SYVC&#39;,
 &#39;OCAD1&#39;,
 &#39;FANCM&#39;,
 &#39;RPC2&#39;,
 &#39;SYLC&#39;,
 &#39;TRAP1&#39;,
 &#39;KIF25&#39;,
 &#39;ABCA5&#39;,
 &#39;CP26B&#39;,
 &#39;CCNK&#39;,
 &#39;ZNF85&#39;,
 &#39;MDM4&#39;,
 &#39;NIPBL&#39;,
 &#39;HECW1&#39;,
 &#39;P63&#39;,
 &#39;ADPRM&#39;,
 &#39;CD275&#39;,
 &#39;FAAA&#39;,
 &#39;TEBP&#39;,
 &#39;RN103&#39;,
 &#39;MYO16&#39;,
 &#39;SAM15&#39;,
 &#39;SCRB2&#39;,
 &#39;NCF2&#39;,
 &#39;NU160&#39;,
 &#39;CD88&#39;,
 &#39;KNTC1&#39;,
 &#39;BTK&#39;,
 &#39;PPIA&#39;,
 &#39;CD300&#39;,
 &#39;CSTN3&#39;,
 &#39;CADH4&#39;,
 &#39;CO4A1&#39;,
 &#39;DGKQ&#39;,
 &#39;THYN1&#39;,
 &#39;ALDR&#39;,
 &#39;BMX&#39;,
 &#39;PRPS1&#39;,
 &#39;KMO&#39;,
 &#39;CD85J&#39;,
 &#39;PPR3A&#39;,
 &#39;ZO3&#39;,
 &#39;BAZ1A&#39;,
 &#39;K1C19&#39;,
 &#39;F120C&#39;,
 &#39;RNF12&#39;,
 &#39;VILI&#39;,
 &#39;GYS2&#39;,
 &#39;DHRS9&#39;,
 &#39;PDE3A&#39;,
 &#39;ENOG&#39;,
 &#39;PSMD2&#39;,
 &#39;MCFD2&#39;,
 &#39;VISTA&#39;,
 &#39;DCC1&#39;,
 &#39;TPPC8&#39;,
 &#39;KPRA&#39;,
 &#39;ATD3A&#39;,
 &#39;BRCA2&#39;,
 &#39;P5F1B&#39;,
 &#39;CAND1&#39;,
 &#39;AT11B&#39;,
 &#39;IGBP1&#39;,
 &#39;ARLY&#39;,
 &#39;GBP7&#39;,
 &#39;SYNEM&#39;,
 &#39;ZAN&#39;,
 &#39;NUP98&#39;,
 &#39;PDS5A&#39;,
 &#39;IF4A1&#39;,
 &#39;BRD8&#39;,
 &#39;MPRIP&#39;,
 &#39;ANR62&#39;,
 &#39;MINY3&#39;,
 &#39;ATAD1&#39;,
 &#39;KGD4&#39;,
 &#39;CYTSB&#39;,
 &#39;TCR.VBETA13.1&#39;,
 &#39;RL12&#39;,
 &#39;CUL1&#39;,
 &#39;PI42B&#39;,
 &#39;PLCB3&#39;,
 &#39;LMTK1&#39;,
 &#39;TUT4&#39;,
 &#39;SPSY&#39;,
 &#39;SSRG&#39;,
 &#39;MYOF&#39;,
 &#39;PAAT&#39;,
 &#39;GCP2&#39;,
 &#39;ECI2&#39;,
 &#39;ZMYM1&#39;,
 &#39;GAB3&#39;,
 &#39;DHB11&#39;,
 &#39;SGT1&#39;,
 &#39;TAM41&#39;,
 &#39;IGG4.IH&#39;,
 &#39;SCFD1&#39;,
 &#39;GUAA&#39;,
 &#39;NFIL3&#39;,
 &#39;CHM1A&#39;,
 &#39;DUS10&#39;,
 &#39;PUS1&#39;,
 &#39;PPRC1&#39;,
 &#39;VEGFA&#39;,
 &#39;MSH5&#39;,
 &#39;DQX1&#39;,
 &#39;BAG3&#39;,
 &#39;SAP&#39;,
 &#39;F184B&#39;,
 &#39;KRIT1&#39;,
 &#39;FXL19&#39;,
 &#39;NUP50&#39;,
 &#39;HS71L&#39;,
 &#39;MTUS2&#39;,
 &#39;GPTC4&#39;,
 &#39;PGC1A.P&#39;,
 &#39;CO8B&#39;,
 &#39;E2AK2&#39;,
 &#39;IMDH1&#39;,
 &#39;PTK7&#39;,
 &#39;STK24&#39;,
 &#39;ILK&#39;,
 &#39;ABCA7&#39;,
 &#39;PDPN&#39;,
 &#39;TXN4A&#39;,
 &#39;HMR1&#39;,
 &#39;RL26&#39;,
 &#39;DIRA3&#39;,
 &#39;BUB3&#39;,
 &#39;ACTS&#39;,
 &#39;ZN626&#39;,
 &#39;ARP19&#39;,
 &#39;ILKAP&#39;,
 &#39;PPAC&#39;,
 &#39;MYOM1&#39;,
 &#39;MRP1&#39;,
 &#39;SC2B2&#39;,
 &#39;CNN3&#39;,
 &#39;PAI2&#39;,
 &#39;THIOM&#39;,
 &#39;VPS41&#39;,
 &#39;CDK6&#39;,
 &#39;STK31&#39;,
 &#39;CAV1&#39;,
 &#39;SCPDL&#39;,
 &#39;CHIKV&#39;,
 &#39;COCA1&#39;,
 &#39;SMRD1&#39;,
 &#39;PRG4&#39;,
 &#39;WASP&#39;,
 &#39;PCSK9&#39;,
 &#39;IL.21&#39;,
 &#39;UGGG1&#39;,
 &#39;KI18A&#39;,
 &#39;ENO1&#39;,
 &#39;ZN292&#39;,
 &#39;MAGT1&#39;,
 &#39;CD282&#39;,
 &#39;ASPDH&#39;,
 &#39;ARSG&#39;,
 &#39;RT23&#39;,
 &#39;CL079&#39;,
 &#39;CX3CR1&#39;,
 &#39;NDUBB&#39;,
 &#39;FBP1L&#39;,
 &#39;ECI1&#39;,
 &#39;CLK1&#39;,
 &#39;CRNL1&#39;,
 &#39;ACSL3&#39;,
 &#39;AFAD&#39;,
 &#39;RB11A&#39;,
 &#39;STRAB&#39;,
 &#39;CC90B&#39;,
 &#39;1433G&#39;,
 &#39;CADHERIN&#39;,
 &#39;RRAS2&#39;,
 &#39;RTL1&#39;,
 &#39;GADL1&#39;,
 &#39;DSG4&#39;,
 &#39;GRSF1&#39;,
 &#39;TCRB&#39;,
 &#39;COA3&#39;,
 &#39;PRC2B&#39;,
 &#39;NXPE2&#39;,
 &#39;ATPD&#39;,
 &#39;ECM29&#39;,
 &#39;TDH&#39;,
 &#39;CL004&#39;,
 &#39;AJM1&#39;,
 &#39;UQCC1&#39;,
 &#39;LYRM2&#39;,
 &#39;CDN2A&#39;,
 &#39;SAHH&#39;,
 &#39;RBM4&#39;,
 &#39;RL18&#39;,
 &#39;OVOL2&#39;,
 &#39;TE2IP&#39;,
 &#39;GYS1&#39;,
 &#39;PPM1D&#39;,
 &#39;ANTR2&#39;,
 &#39;RHG31&#39;,
 &#39;PSMD4&#39;,
 &#39;CD85A&#39;,
 &#39;LIN41&#39;,
 &#39;RL7L&#39;,
 &#39;CRK&#39;,
 &#39;DHX16&#39;,
 &#39;TBC31&#39;,
 &#39;DAPK1&#39;,
 &#39;EVPL&#39;,
 &#39;CPNE1&#39;,
 &#39;LAMA3&#39;,
 &#39;LRRN1&#39;,
 &#39;RL18A&#39;,
 &#39;CAN14&#39;,
 &#39;EFL1&#39;,
 &#39;RL19&#39;,
 &#39;RL22&#39;,
 &#39;THTR&#39;,
 &#39;ALG1&#39;,
 &#39;CS&#39;,
 &#39;ARP5L&#39;,
 &#39;EMAL4&#39;,
 &#39;TS1R1&#39;,
 &#39;TNPO1&#39;,
 &#39;COR1B&#39;,
 &#39;MYLK&#39;,
 &#39;ALG3&#39;,
 &#39;CD35&#39;,
 &#39;NRBP&#39;,
 &#39;COPA&#39;,
 &#39;CD229&#39;,
 &#39;DCTP1&#39;,
 &#39;RYBP&#39;,
 &#39;TX1B3&#39;,
 &#39;TRI60&#39;,
 &#39;WASF3&#39;,
 &#39;STIL&#39;,
 &#39;IKZF1&#39;,
 &#39;BCCIP&#39;,
 &#39;ZMY15&#39;,
 &#39;SNED1&#39;,
 &#39;ALPK3&#39;,
 &#39;CPNE6&#39;,
 &#39;GCC2&#39;,
 &#39;DDX6&#39;,
 &#39;FLOT2&#39;,
 &#39;LONP2&#39;,
 &#39;CELR3&#39;,
 &#39;DPP8&#39;,
 &#39;LAP&#39;,
 &#39;VPS4B&#39;,
 &#39;SH3G1&#39;,
 &#39;DNAS1&#39;,
 &#39;MTND&#39;,
 &#39;CD8&#39;,
 &#39;CISD2&#39;,
 &#39;CD90&#39;,
 &#39;COX5A&#39;,
 &#39;EIF2A&#39;,
 &#39;PSMD1&#39;,
 &#39;ADCK1&#39;,
 &#39;YK004&#39;,
 &#39;ATX2L&#39;,
 &#39;DLDH&#39;,
 &#39;NDST3&#39;,
 &#39;CENPC&#39;,
 &#39;STK19&#39;,
 &#39;PARVB&#39;,
 &#39;DDX49&#39;,
 &#39;F157A&#39;,
 &#39;OVGP1&#39;,
 &#39;SYUA&#39;,
 &#39;LMTK3&#39;,
 &#39;CD85H&#39;,
 &#39;TCPQ&#39;,
 &#39;NOL11&#39;,
 &#39;R10B1&#39;,
 &#39;FAKD4&#39;,
 &#39;APLP2&#39;,
 &#39;NUCB1&#39;,
 &#39;SEM3C&#39;,
 &#39;GLYG&#39;,
 &#39;TOM20&#39;,
 &#39;CD257&#39;,
 &#39;PABP5&#39;,
 &#39;RM53&#39;,
 &#39;HECD1&#39;,
 &#39;CD133&#39;,
 &#39;PPIL3&#39;,
 &#39;KCC4&#39;,
 &#39;AUTS2&#39;,
 &#39;PCH2&#39;,
 &#39;CD62L&#39;,
 &#39;SNRK&#39;,
 &#39;NPM3&#39;,
 &#39;CD210&#39;,
 &#39;CD11A&#39;,
 &#39;RT24&#39;,
 &#39;ARVC&#39;,
 &#39;MBNL2&#39;,
 &#39;PAQR1&#39;,
 &#39;HCK&#39;,
 &#39;ELMO3&#39;,
 &#39;PGAP1&#39;,
 &#39;RS18&#39;,
 &#39;CD252&#39;,
 &#39;CHFR&#39;,
 &#39;NELL1&#39;,
 &#39;PEX6&#39;,
 &#39;TTLL8&#39;,
 &#39;RGS8&#39;,
 &#39;TCP4&#39;,
 &#39;KEAP1&#39;,
 &#39;KIN17&#39;,
 &#39;SAE1&#39;,
 &#39;GARL3&#39;,
 &#39;PCD19&#39;,
 &#39;ZNF81&#39;,
 &#39;NFAT&#39;,
 &#39;CLEC1B&#39;,
 &#39;IL17F&#39;,
 &#39;SPT5H&#39;,
 &#39;CD7&#39;,
 &#39;SMAP&#39;,
 &#39;ADT4&#39;,
 &#39;TTC17&#39;,
 &#39;VATE1&#39;,
 &#39;CD123&#39;,
 &#39;ZN641&#39;,
 &#39;AGRV1&#39;,
 &#39;NH2L1&#39;,
 &#39;VWC2L&#39;,
 &#39;UHRF2&#39;,
 &#39;HDC&#39;,
 &#39;CD44&#39;,
 &#39;TSN11&#39;,
 &#39;UAP1&#39;,
 &#39;NRDC&#39;,
 &#39;FKBP4&#39;,
 &#39;CFA54&#39;,
 &#39;GDE&#39;,
 &#39;TCR.GAMMA&#39;,
 &#39;ARMT1&#39;,
 &#39;HEAT3&#39;,
 &#39;AT5EL&#39;,
 &#39;SYBU&#39;,
 &#39;CA2D4&#39;,
 &#39;CD107B&#39;,
 &#39;RS5&#39;,
 &#39;CD178&#39;,
 &#39;PP1G&#39;,
 &#39;GCNA&#39;,
 &#39;S1PROBE&#39;,
 &#39;ZFAT&#39;,
 &#39;PK3CA&#39;,
 &#39;ATX10&#39;,
 &#39;MED24&#39;,
 &#39;ARP3&#39;,
 &#39;PHF5A&#39;,
 &#39;VAMP5&#39;,
 &#39;SPICE&#39;,
 &#39;PPR3D&#39;,
 &#39;RXRG&#39;,
 &#39;PSB5&#39;,
 &#39;CIR1&#39;,
 &#39;CNGB3&#39;,
 &#39;TBA4A&#39;,
 &#39;NID1&#39;,
 &#39;CS2IP&#39;,
 &#39;NEXN&#39;,
 &#39;EST1&#39;,
 &#39;H2A1D&#39;,
 &#39;RAGP1&#39;,
 &#39;IST1&#39;,
 &#39;THOC4&#39;,
 &#39;GALECTIN9&#39;,
 &#39;GMPR1&#39;,
 &#39;STRC&#39;,
 &#39;TCPA&#39;,
 &#39;SLIK3&#39;,
 &#39;AKP13&#39;,
 &#39;SET1B&#39;,
 &#39;HEBP1&#39;,
 &#39;SCAM2&#39;,
 &#39;ESYT2&#39;,
 &#39;SNR40&#39;,
 &#39;FKBP9&#39;,
 &#39;IFNA&#39;,
 &#39;RT10&#39;,
 &#39;CBPD&#39;,
 &#39;TMA7&#39;,
 &#39;HLA.E&#39;,
 &#39;RTN3&#39;,
 &#39;SG3A2&#39;,
 &#39;INTEGRIN.A9B1&#39;,
 &#39;CRML&#39;,
 &#39;PRP16&#39;,
 &#39;AP1M2&#39;,
 &#39;PCX1&#39;,
 &#39;SLIK4&#39;,
 &#39;CD94&#39;,
 &#39;CD276&#39;,
 &#39;AK1C3&#39;,
 &#39;EMAL2&#39;,
 &#39;PEX5&#39;,
 &#39;VINEX&#39;,
 &#39;MEX3D&#39;,
 &#39;SQOR&#39;,
 &#39;RBM10&#39;,
 &#39;FAT2&#39;,
 &#39;PP2AB&#39;,
 &#39;TBB2B&#39;,
 &#39;RPR1B&#39;,
 &#39;ZC3H3&#39;,
 &#39;ANXA1&#39;,
 &#39;SLIK1&#39;,
 &#39;RS16&#39;,
 &#39;CD16B&#39;,
 &#39;FXR1&#39;,
 &#39;TP53B&#39;,
 &#39;BTNLA&#39;,
 &#39;RPB7&#39;,
 &#39;RALY&#39;,
 &#39;PSB4&#39;,
 &#39;CP250&#39;,
 &#39;EIF3J&#39;,
 &#39;CD365&#39;,
 &#39;MTPN&#39;,
 &#39;AT11A&#39;,
 &#39;DCAF5&#39;,
 &#39;ZN840&#39;,
 &#39;TM52B&#39;,
 &#39;ARFG2&#39;,
 &#39;ZN596&#39;,
 &#39;SHLB2&#39;,
 &#39;PSMF1&#39;,
 &#39;HNRPQ&#39;,
 &#39;SYCC&#39;,
 &#39;IDUA&#39;,
 &#39;SYQ&#39;,
 &#39;UN13D&#39;,
 &#39;CCD70&#39;,
 &#39;PRRT4&#39;,
 &#39;CC124&#39;,
 &#39;DREB&#39;,
 &#39;PTH2R&#39;,
 &#39;SAM14&#39;,
 &#39;F162A&#39;,
 &#39;ZN425&#39;,
 &#39;PDE4A&#39;,
 &#39;TOM22&#39;,
 &#39;DX39B&#39;,
 &#39;NUDT5&#39;,
 &#39;CABP7&#39;,
 &#39;S29P2&#39;,
 &#39;CSN3&#39;,
 &#39;NOL10&#39;,
 &#39;MTMR6&#39;,
 &#39;RLA1&#39;,
 &#39;APC7&#39;,
 &#39;PFD6&#39;,
 &#39;NBEA&#39;,
 &#39;NCOA5&#39;,
 &#39;ACADS&#39;,
 &#39;BRCA1&#39;,
 &#39;HARB1&#39;,
 &#39;CD019&#39;,
 &#39;MATR3&#39;,
 &#39;IQGA1&#39;,
 &#39;PRS8&#39;,
 &#39;CLD10&#39;,
 &#39;CX7A2&#39;,
 &#39;NUDC2&#39;,
 &#39;P3C2B&#39;,
 &#39;ARPC5&#39;,
 &#39;GPCP1&#39;,
 &#39;AUHM&#39;,
 &#39;TRRAP&#39;,
 &#39;TCR.Y.D&#39;,
 &#39;S6&#39;,
 &#39;LTOR5&#39;,
 &#39;KRR1&#39;,
 &#39;TCPR1&#39;,
 &#39;WBP1&#39;,
 &#39;FGD6&#39;,
 &#39;BTF3&#39;,
 &#39;HPLN1&#39;,
 &#39;PFD4&#39;,
 &#39;ZC11A&#39;,
 &#39;WDR82&#39;,
 &#39;CD215&#39;,
 &#39;RLA0&#39;,
 &#39;TBX2&#39;,
 &#39;DDX56&#39;,
 &#39;INSL3&#39;,
 &#39;ZNT3&#39;,
 &#39;SERP3&#39;,
 &#39;METK2&#39;,
 &#39;CTBL1&#39;,
 &#39;POF1B&#39;,
 &#39;GRAP2&#39;,
 &#39;PLAK&#39;,
 &#39;PESC&#39;,
 &#39;HMMR&#39;,
 &#39;CB078&#39;,
 &#39;CRBG3&#39;,
 &#39;OSGEP&#39;,
 &#39;CD108&#39;,
 &#39;H1X&#39;,
 &#39;CD352&#39;,
 &#39;RPGF5&#39;,
 &#39;5MP2&#39;,
 &#39;TFAP4&#39;,
 &#39;ZN519&#39;,
 &#39;CD45RB&#39;,
 &#39;ZN608&#39;,
 &#39;TENS1&#39;,
 &#39;EIF3E&#39;,
 &#39;IFNA2&#39;,
 &#39;PRA33&#39;,
 &#39;CF20D&#39;,
 &#39;ATP5J&#39;,
 &#39;LRRF1&#39;,
 &#39;UBX2A&#39;,
 &#39;UQCC2&#39;,
 &#39;CA159&#39;,
 &#39;MUCL3&#39;,
 &#39;AKTS1&#39;,
 &#39;RAB8B&#39;,
 &#39;PLPL2&#39;,
 &#39;VSXL2&#39;,
 &#39;ABCAC&#39;,
 &#39;DYST&#39;,
 &#39;RNFT2&#39;,
 &#39;UTP4&#39;,
 &#39;HXC10&#39;,
 &#39;CFA74&#39;,
 &#39;CPIN1&#39;,
 &#39;RASN&#39;,
 &#39;FBSL&#39;,
 &#39;PRP8&#39;,
 &#39;CD182&#39;,
 &#39;DNJC2&#39;,
 &#39;TCR.VA7&#39;,
 &#39;SH3B4&#39;,
 &#39;RS8&#39;,
 &#39;NDKA&#39;,
 &#39;ESPNL&#39;,
 &#39;MEG10&#39;,
 &#39;SNX29&#39;,
 &#39;RPB9&#39;,
 &#39;UT14A&#39;,
 &#39;UBF1&#39;,
 &#39;FKBP5&#39;,
 &#39;EPAS1&#39;,
 &#39;SYSC&#39;,
 &#39;AOL&#39;,
 &#39;ZN471&#39;,
 &#39;PLOD2&#39;,
 &#39;KHDR1&#39;,
 &#39;HERC3&#39;,
 &#39;CPT2&#39;,
 &#39;TM1L1&#39;,
 &#39;KIRS.PE&#39;,
 &#39;MMP25&#39;,
 &#39;TM104&#39;,
 &#39;CD4&#39;,
 &#39;DDX41&#39;,
 &#39;MED17&#39;,
 &#39;ACL6A&#39;,
 &#39;CD165&#39;,
 &#39;DHB13&#39;,
 &#39;ZCH18&#39;,
 &#39;MAGB1&#39;,
 &#39;PR40B&#39;,
 &#39;CCDC6&#39;,
 &#39;UBP44&#39;,
 &#39;PLD2&#39;,
 &#39;SCG2&#39;,
 &#39;ETAA1&#39;,
 &#39;CDV3&#39;,
 &#39;RBGPR&#39;,
 &#39;CD5&#39;,
 &#39;PINX1&#39;,
 &#39;TSN13&#39;,
 &#39;ARRS&#39;,
 &#39;VN1R5&#39;,
 &#39;M4K4&#39;,
 &#39;DENR&#39;,
 &#39;RPN1&#39;,
 &#39;OR6K6&#39;,
 &#39;PAIP1&#39;,
 &#39;UBP48&#39;,
 &#39;ERP44&#39;,
 &#39;CCG6&#39;,
 &#39;UGDH&#39;,
 &#39;GL1AD&#39;,
 &#39;KINH&#39;,
 &#39;TGO1&#39;,
 &#39;CYB5B&#39;,
 &#39;RGS5&#39;,
 &#39;ENSA&#39;,
 &#39;H90B4&#39;,
 &#39;MYH6&#39;,
 &#39;UROK&#39;,
 &#39;RRP5&#39;,
 &#39;KANL1&#39;,
 &#39;CHSP1&#39;,
 &#39;MYO3B&#39;,
 &#39;DBNL&#39;,
 &#39;KALM&#39;,
 &#39;MAGB3&#39;,
 &#39;SPTB1&#39;,
 &#39;API5&#39;,
 &#39;CD207&#39;,
 &#39;CPPED&#39;,
 &#39;TBCE&#39;,
 &#39;CLC2B&#39;,
 &#39;CX6B1&#39;,
 &#39;FBRL&#39;,
 &#39;PSME1&#39;,
 &#39;AGRB1&#39;,
 &#39;OR1L1&#39;,
 &#39;HYDIN&#39;,
 &#39;TRPC1&#39;,
 &#39;EFNA1&#39;,
 &#39;CEP55&#39;,
 &#39;RTCA&#39;,
 &#39;BCL9L&#39;,
 &#39;ARP2&#39;,
 &#39;ODP2&#39;,
 &#39;COX41&#39;,
 &#39;CH086&#39;,
 &#39;GCDH&#39;,
 &#39;ZN582&#39;,
 &#39;TCF7&#39;,
 &#39;CCD89&#39;,
 &#39;PRTN3&#39;,
 &#39;CCD86&#39;,
 &#39;PBDC1&#39;,
 &#39;BLM&#39;,
 &#39;RSLBB&#39;,
 &#39;CFAI&#39;,
 &#39;ULK1&#39;,
 &#39;IGSF1&#39;,
 &#39;SMC1A&#39;,
 &#39;SHOC2&#39;,
 &#39;DJC11&#39;,
 &#39;POP7&#39;,
 &#39;HSDL2&#39;,
 &#39;SUV3&#39;,
 &#39;UGPA&#39;,
 &#39;PEBP1&#39;,
 &#39;SUMO2&#39;,
 &#39;RM17&#39;,
 &#39;ACLY&#39;,
 &#39;CTND2&#39;,
 &#39;ICAM5&#39;,
 &#39;NONO&#39;,
 &#39;LARP4&#39;,
 &#39;EWS&#39;,
 &#39;MED1&#39;,
 &#39;MCR&#39;,
 &#39;TCR.1&#39;,
 &#39;DNJC4&#39;,
 &#39;SRRM2&#39;,
 &#39;CD381&#39;,
 &#39;DDX21&#39;,
 &#39;CD274&#39;,
 &#39;RT09&#39;,
 &#39;GOLI4&#39;,
 &#39;ZC12C&#39;,
 &#39;NPSR1&#39;,
 &#39;TLK2&#39;,
 &#39;ZNF41&#39;,
 &#39;PNPH&#39;,
 &#39;PLPP7&#39;,
 &#39;GDIR2&#39;,
 &#39;LIMA1&#39;,
 &#39;HAOX2&#39;,
 &#39;GBRA1&#39;,
 &#39;ADAS&#39;,
 &#39;CNN1&#39;,
 &#39;CPSF2&#39;,
 &#39;ATLA3&#39;,
 &#39;ERIC1&#39;,
 &#39;PYGL&#39;,
 &#39;PELO&#39;,
 &#39;SMC2&#39;,
 &#39;CD3&#39;,
 &#39;TF65&#39;,
 &#39;AR13B&#39;,
 &#39;ARF4&#39;,
 &#39;SYNP2&#39;,
 &#39;ROBO1&#39;,
 &#39;PGRP4&#39;,
 &#39;CENPV&#39;,
 &#39;AKAP1&#39;,
 &#39;C1S&#39;,
 &#39;NACA2&#39;,
 &#39;SYIM&#39;,
 &#39;SAFB2&#39;,
 &#39;NOP53&#39;,
 &#39;XRCC6&#39;,
 &#39;ABLM3&#39;,
 &#39;TEKT1&#39;,
 &#39;FBW1B&#39;,
 &#39;NTPCR&#39;,
 &#39;NKD1&#39;,
 &#39;DDI2&#39;,
 &#39;ELAV1&#39;,
 &#39;CALM1&#39;,
 &#39;OR6Y1&#39;,
 &#39;BRI3B&#39;,
 &#39;OGT1&#39;,
 &#39;KAD3&#39;,
 &#39;SNX6&#39;,
 &#39;XBP1&#39;,
 &#39;CBPC4&#39;,
 &#39;PPP5&#39;,
 &#39;PLSL&#39;,
 &#39;ICAL&#39;,
 &#39;TCR.VA24.JA18&#39;,
 &#39;TDIF2&#39;,
 &#39;PCY1A&#39;,
 &#39;ARHGI&#39;,
 &#39;BBS2&#39;,
 &#39;CD49A&#39;,
 &#39;UBP42&#39;,
 &#39;UBE3A&#39;,
 &#39;TBB6&#39;,
 &#39;PP2AA&#39;,
 &#39;ALDH2&#39;,
 &#39;DEN4C&#39;,
 &#39;A4&#39;,
 &#39;UBP31&#39;,
 &#39;RTEL1&#39;,
 &#39;TTC22&#39;,
 &#39;PXDC1&#39;,
 &#39;VIP1&#39;,
 &#39;AGRA3&#39;,
 &#39;UBP11&#39;,
 &#39;ZBED4&#39;,
 &#39;PRDX6&#39;,
 &#39;IF172&#39;,
 &#39;ORC5&#39;,
 &#39;SF3A2&#39;,
 &#39;NNMT&#39;,
 &#39;GLR&#39;,
 &#39;PCKGM&#39;,
 &#39;NRG2&#39;,
 &#39;STAU1&#39;,
 &#39;BD1L1&#39;,
 &#39;CARL1&#39;,
 &#39;MUC21&#39;,
 &#39;TRIPB&#39;,
 &#39;CD054&#39;,
 &#39;ALKB5&#39;,
 &#39;CY24A&#39;,
 &#39;KCY&#39;,
 &#39;M3K6&#39;,
 &#39;SYNC&#39;,
 &#39;PCDH8&#39;,
 &#39;SCAF4&#39;,
 &#39;LELP1&#39;,
 &#39;NHP2&#39;,
 &#39;JUPI2&#39;,
 &#39;TRUB1&#39;,
 &#39;RU2A&#39;,
 &#39;CFA58&#39;,
 &#39;CERS2&#39;,
 &#39;RAP2B&#39;,
 &#39;PYAS1&#39;,
 &#39;SRSF9&#39;,
 &#39;SOX9&#39;,
 &#39;CD8B.2ST8.5H7&#39;,
 &#39;EFC11&#39;,
 &#39;TIAM1&#39;,
 &#39;ADCY1&#39;,
 &#39;CPT1A&#39;,
 &#39;ACOT9&#39;,
 &#39;FERM1&#39;,
 &#39;PSMD5&#39;,
 &#39;AATC&#39;,
 &#39;EMC2&#39;,
 &#39;GNAS2&#39;,
 &#39;ERB&#39;,
 &#39;ARHGB&#39;,
 &#39;SYYM&#39;,
 &#39;C1QBP&#39;,
 &#39;FANK1&#39;,
 &#39;PSB1&#39;,
 &#39;GDN&#39;,
 &#39;STT3A&#39;,
 &#39;LGSN&#39;,
 &#39;CD97&#39;,
 &#39;PSMG1&#39;,
 &#39;CC178&#39;,
 &#39;PUR4&#39;,
 &#39;CD158E1&#39;,
 &#39;MF2L2&#39;,
 &#39;PA24C&#39;,
 &#39;SCML1&#39;,
 &#39;TRPV5&#39;,
 &#39;ATRX&#39;,
 &#39;XRN2&#39;,
 &#39;CTNA2&#39;,
 &#39;DNJC9&#39;,
 &#39;NEUL&#39;,
 &#39;HNRL1&#39;,
 &#39;SMCA2&#39;,
 &#39;KRT85&#39;,
 &#39;CAVN2&#39;,
 &#39;MUC5A&#39;,
 &#39;DRC2&#39;,
 &#39;KCNH8&#39;,
 &#39;TDRD5&#39;,
 &#39;UTP11&#39;,
 &#39;VP13C&#39;,
 &#39;TM109&#39;,
 &#39;MAT2B&#39;,
 &#39;NU188&#39;,
 &#39;CNPY4&#39;,
 &#39;LAT2&#39;,
 &#39;PSMD9&#39;,
 &#39;CD324&#39;,
 &#39;SPAG7&#39;,
 &#39;BUD31&#39;,
 &#39;ATG3&#39;,
 &#39;ARFP2&#39;,
 &#39;COPG2&#39;,
 &#39;PEAK3&#39;,
 &#39;LARG1&#39;,
 &#39;CILK1&#39;,
 &#39;WDR44&#39;,
 &#39;CPSM&#39;,
 ...]
</pre></div></div>
</div>
</section>
<section id="3.-Expand-and-save">
<h2>3. Expand and save<a class="headerlink" href="#3.-Expand-and-save" title="Permalink to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>pro_expanded = expand_protein_to_panel(pro, panel, id_col=None)
print(&#39;Expanded shape:&#39;, pro_expanded.shape)
pro_expanded.write_h5ad(OUT_H5AD, compression=COMPRESSION)
print(&#39;Saved to:&#39;, OUT_H5AD)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Expanded shape: (10546, 6427)
Saved to: ../../docs/tutorials/expanded_output/pro_expanded_6427.h5ad
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
../../scLinguist/data_loaders/data_loader.py:894: ImplicitModificationWarning: Trying to modify attribute `.var` of view, initializing view as actual.
  pro.var[&#34;feature_id&#34;] = pro.var_names
</pre></div></div>
</div>
</section>
<section id="4.-Quick-check">
<h2>4. Quick check<a class="headerlink" href="#4.-Quick-check" title="Permalink to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre><span></span>print(&#39;First 10 names:&#39;, list(pro_expanded.var_names[:10]))
print(&#39;Total vars:&#39;, pro_expanded.n_vars)
missing = [p for p in panel if p not in set(pro.var_names)]
print(&#39;Missing count from source (filled with zeros):&#39;, len(missing))
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
First 10 names: [&#39;SP110&#39;, &#39;GTPBA&#39;, &#39;SNX2&#39;, &#39;FRG1&#39;, &#39;TT21A&#39;, &#39;RHG18&#39;, &#39;AR&#39;, &#39;DOCK1&#39;, &#39;RAB1A&#39;, &#39;MUC1.HMFG2&#39;]
Total vars: 6427
Missing count from source (filled with zeros): 6417
</pre></div></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Min Li Lab.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>